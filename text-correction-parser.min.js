"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}();!function(){var e=[{name:"left-wrong-replaced",opening:"[r]",closing:">>",template:'<span class="left-wrong-replaced">%</span>'},{name:"right-right-replaced",opening:">>",closing:"[/r]",template:'<span class="right-right-replaced">%</span>'},{name:"left-right-replaced",opening:"[r]",closing:"<<",template:'<span class="left-right-replaced">%</span>'},{name:"right-wrong-replaced",opening:"<<",closing:"[/r]",template:'<span class="right-wrong-replaced">%</span>'},{name:"deleted",opening:"[d]",closing:"[/d]",template:'<span class="deleted">%</span>'},{name:"added",opening:"[a]",closing:"[/a]",template:'<span class="added">%</span>'}],n=function(){function n(e){_classCallCheck(this,n),this.data=e,this.parsed,this.dindex,this.currentCandidates,this.cchar,this.enclosedText,this.resetVars()}return _createClass(n,[{key:"resetVars",value:function(){this.parsed="",this.dindex=0,this.currentCandidates=[],this.cchar="",this.enclosedText=""}},{key:"parse",value:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.data;this.data=t,this.resetVars();var i=void 0,r=void 0,a=!1;for(this.dindex=0;this.dindex<this.data.length;++this.dindex){if(this.cchar=this.data[this.dindex],i=new RegExp("^"+this.escapeRegExp(this.cchar)),this.currentCandidates.length){if(!e.filter(function(e){return i.test(e.closing)}).length){this.addCharToEnclosedText();continue}if("continue"===function(){var e=n.findEnclosers("closing");return e.length?(r=n.currentCandidates.filter(function(n){for(var t in e)if(n===e[t])return!0;return!1})).length?(n.parsed+=r[0].template.replace("%",n.enclosedText),n.currentCandidates=[],a=!0,void(n.enclosedText="")):(a=!1,n.addCharToEnclosedText(),"continue"):(n.addCharToEnclosedText(),"continue")}())continue}e.filter(function(e){return i.test(e.opening)}).length&&(this.currentCandidates=this.findEnclosers("opening"),this.currentCandidates.length)?this.dindex+=this.currentCandidates[0].opening.length-1:a?(this.dindex+=r[0].closing.length-1,a=!1):this.parsed+=this.cchar}return this.parsed}},{key:"addCharToEnclosedText",value:function(){this.enclosedText+=this.cchar}},{key:"findEnclosers",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"opening",t=0,i="",r=void 0,a=void 0,s=void 0;do{if(i+=this.data[this.dindex+t],t++,(r=e.filter(function(e){return e[n]===i})).length)return r;s=new RegExp("^"+this.escapeRegExp(i)),a=e.filter(function(e){return s.test(e[n])})}while(a.length);return[]}},{key:"escapeRegExp",value:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}}]),n}();n.enclosers=e;var t={},i=!0,r=!1,a=void 0;try{for(var s,c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value;t[l.name]=l}}catch(e){r=!0,a=e}finally{try{!i&&c.return&&c.return()}finally{if(r)throw a}}n.enclosersMap=t,window.TextCorrectionParser=n}();