<!doctype html>
<html>
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">

    <title>text correction parser</title>
    <link rel="import" href="./text-correction-parser.html">
</head>
<body>

<style>
  body {
    font-family: arial;
  }
  section {
    max-width: 500px;
    margin: 10px auto;
    padding: 0 20px;
  }
  textarea, pre, text-correction-parser {
    border: 1px solid #616161;
    border-radius: 3px;
    padding: 10px;
    box-sizing: border-box;
    width: 100%;
    white-space: nowrap;
    overflow-x: auto;
    margin: 0;
    font-family: arial;
    font-size: .89rem;
  }
  textarea {
    min-height: 100px;
  }
  p {
    margin-bottom: 0;
  }
</style>
<section>

<p>input</p>
<textarea id="input">
[a]added[/a].
[d]deleted[/d].
[r]rplc>>replacement[/r]
[r]replacement<<rplc[/r]
</textarea>

<!-- <span class="arrow">↓↓↓</span> -->
<p>parsed (pre)</p>
<pre id="pre"></pre>

<!-- <span class="arrow">↓↓↓</span> -->
<p>formatted output</p>
<text-correction-parser id=output data="[a]this[/a]"></text-correction-parser>

</section>

<script>
(function () {
  'use strict';

  const tcp = new window.TextCorrectionParser();

  function parseInput() {
    let parsed = tcp.parse(input.value);
    pre.innerText = parsed;
    output.data = nl2br(parsed);
  }

  function nl2br(str, is_xhtml) {
    var breakTag = (is_xhtml || typeof is_xhtml === 'undefined') ? '<br />' : '<br>';
    return (str + '').replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g, '$1' + breakTag + '$2');
  }

  input.addEventListener('keyup', parseInput);

  parseInput();
})();
</script>
</body>
</html>